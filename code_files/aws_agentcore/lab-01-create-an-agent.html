<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 1: Creating a simple customer support agent prototype – Aarushi Nema</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-710753787207b25228f8cf56d22a49c7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Aarushi Nema</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../design_portfolio.html"> 
<span class="menu-text">Design Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../art.html"> 
<span class="menu-text">Art</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/aarushi-nema"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/aarushi-nema-64a006185/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 1: Creating a simple customer support agent prototype</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p><a href="https://aws.amazon.com/bedrock/agentcore/">Amazon Bedrock AgentCore</a> helps you deploying and operating AI agents securely at scale - using any framework and model. It provides you with the capability to move from prototype to production faster.</p>
<p>In this 5-labs tutorial, we will demonstrate the end-to-end journey from prototype to production using a <strong>Customer Support Agent</strong>. For this example we will use <a href="https://strandsagents.com/latest/">Strands Agents</a>, a simple-to-use, code-first framework for building agents and the Anthropic Claude Sonnet 3.7 model from Amazon Bedrock. For your application you can use the framework and model of your choice. It’s important to note that the concepts covered here can be applied using other frameworks and models as well.</p>
<p><strong>Workshop Journey:</strong> - <strong>Lab 1 (Current)</strong>: Create Agent Prototype - Build a functional customer support agent - <strong>Lab 2</strong>: Enhance with Memory - Add conversation context and personalization - <strong>Lab 3</strong>: Scale with Gateway &amp; Identity - Share tools across agents securely - <strong>Lab 4</strong>: Deploy to Production - Use AgentCore Runtime with observability - <strong>Lab 5</strong>: Build User Interface - Create a customer-facing application</p>
<p>In this first lab, we’ll build a Customer Support Agent prototype that will evolve throughout the workshop into a production-ready system serving multiple customers with persistent memory, shared tools, and full observability. Our agent will have the following local tools available: - <strong>get_return_policy()</strong> - Get return policy for specific products - <strong>get_product_info()</strong> - Get product information - <strong>web_search()</strong> - Search the web for troubleshooting help - <strong>get_technical_support()</strong> - Search a Bedrock Knowledge Base</p>
</section>
<section id="architecture-for-lab-1" class="level3">
<h3 class="anchored" data-anchor-id="architecture-for-lab-1">Architecture for Lab 1</h3>
<div style="text-align:left">
<pre><code>&lt;img src="images/architecture_lab1_strands.png" width="75%"/&gt;</code></pre>
</div>
<p><em>Simple prototype running locally. In subsequent labs, we’ll migrate this to AgentCore services with shared tools, persistent memory, and production-grade observability.</em></p>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<ul>
<li><strong>AWS Account</strong> with appropriate permissions</li>
<li><strong>Python 3.10+</strong> installed locally</li>
<li><strong>AWS CLI configured</strong> with credentials</li>
<li><strong>Anthropic Claude 3.7</strong> enabled on <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/model-access.html">Amazon Bedrock</a></li>
<li><strong>Strands Agents</strong> and other libraries installed in the next cells</li>
</ul>
</section>
<section id="step-1-install-dependencies-and-import-libraries" class="level3">
<h3 class="anchored" data-anchor-id="step-1-install-dependencies-and-import-libraries">Step 1: Install Dependencies and Import Libraries</h3>
<p>Before we start, let’s install the pre-requisites for this lab</p>
<div id="cell-3" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:41:16.291902Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:41:16.291545Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:41:20.039009Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:41:20.038501Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:41:16.291883Z&quot;}}" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install required packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install <span class="op">-</span>U <span class="op">-</span>r requirements.txt <span class="op">-</span>q</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: you may need to restart the kernel to use updated packages.</code></pre>
</div>
</div>
<p>We can now import the required libraries and initialize our boto3 session</p>
<div id="cell-5" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:41:25.405748Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:41:25.405483Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:41:25.990783Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:41:25.990179Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:41:25.405723Z&quot;}}" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> boto3.session <span class="im">import</span> Session</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ddgs.exceptions <span class="im">import</span> DDGSException, RatelimitException</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ddgs <span class="im">import</span> DDGS</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands.tools <span class="im">import</span> tool</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lab_helpers.utils <span class="im">import</span> put_ssm_parameter</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-6" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:42:17.935472Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:42:17.935112Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:42:17.945587Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:42:17.944932Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:42:17.935451Z&quot;}}" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get boto session</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>boto_session <span class="op">=</span> Session()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>region <span class="op">=</span> boto_session.region_name</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="step-2-implementing-custom-tools" class="level3">
<h3 class="anchored" data-anchor-id="step-2-implementing-custom-tools">Step 2: Implementing custom tools</h3>
<p>Next, we will implement the 3 tools which will be provided to the Customer Support Agent.</p>
<p>Defining tools in Strands Agent is extremely simple, just add a <code>@tool</code> decorator to your function, and provide a description of the tool in the function’s docstring. Strands Agents will use the function documentation, typing and arguments to provide context on this tool to your agent.</p>
<section id="tool-1-get-return-policy" class="level4">
<h4 class="anchored" data-anchor-id="tool-1-get-return-policy">Tool 1: Get Return Policy</h4>
<p><strong>Purpose:</strong> This tool helps customers understand return policies for different product categories. It provides detailed information about return windows, conditions, processes, and refund timelines so customers know exactly what to expect when returning items.</p>
<div id="cell-9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:43:23.076580Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:43:23.076318Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:43:23.117656Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:43:23.117111Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:43:23.076559Z&quot;}}" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># @tool -&gt; for agent to communicate with </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">@tool</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_return_policy(product_category: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Get return policy information for a specific product category.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">        product_category: Electronics category (e.g., 'smartphones', 'laptops', 'accessories')</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">        Formatted return policy details including timeframes and conditions</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mock return policy database - in real implementation, this would query policy database</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    return_policies <span class="op">=</span> {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"smartphones"</span>: {</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"window"</span>: <span class="st">"30 days"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"condition"</span>: <span class="st">"Original packaging, no physical damage, factory reset required"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"process"</span>: <span class="st">"Online RMA portal or technical support"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"refund_time"</span>: <span class="st">"5-7 business days after inspection"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"shipping"</span>: <span class="st">"Free return shipping, prepaid label provided"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"1-year manufacturer warranty included"</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">"laptops"</span>: {</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"window"</span>: <span class="st">"30 days"</span>, </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"condition"</span>: <span class="st">"Original packaging, all accessories, no software modifications"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"process"</span>: <span class="st">"Technical support verification required before return"</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">"refund_time"</span>: <span class="st">"7-10 business days after inspection"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">"shipping"</span>: <span class="st">"Free return shipping with original packaging"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"1-year manufacturer warranty, extended options available"</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"accessories"</span>: {</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"window"</span>: <span class="st">"30 days"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">"condition"</span>: <span class="st">"Unopened packaging preferred, all components included"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">"process"</span>: <span class="st">"Online return portal"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"refund_time"</span>: <span class="st">"3-5 business days after receipt"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"shipping"</span>: <span class="st">"Customer pays return shipping under $50"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"90-day manufacturer warranty"</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Default policy for unlisted categories</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    default_policy <span class="op">=</span> {</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"window"</span>: <span class="st">"30 days"</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"condition"</span>: <span class="st">"Original condition with all included components"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"process"</span>: <span class="st">"Contact technical support"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"refund_time"</span>: <span class="st">"5-7 business days after inspection"</span>, </span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"shipping"</span>: <span class="st">"Return shipping policies vary"</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"warranty"</span>: <span class="st">"Standard manufacturer warranty applies"</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    policy <span class="op">=</span> return_policies.get(product_category.lower(), default_policy)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"Return Policy - </span><span class="sc">{</span>product_category<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">:</span><span class="ch">\n\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Return window: </span><span class="sc">{</span>policy[<span class="st">'window'</span>]<span class="sc">}</span><span class="ss"> from delivery</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Condition: </span><span class="sc">{</span>policy[<span class="st">'condition'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Process: </span><span class="sc">{</span>policy[<span class="st">'process'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Refund timeline: </span><span class="sc">{</span>policy[<span class="st">'refund_time'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Shipping: </span><span class="sc">{</span>policy[<span class="st">'shipping'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Warranty: </span><span class="sc">{</span>policy[<span class="st">'warranty'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✅ Return policy tool ready"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Return policy tool ready</code></pre>
</div>
</div>
</section>
<section id="tool-2-get-product-information" class="level4">
<h4 class="anchored" data-anchor-id="tool-2-get-product-information">Tool 2: Get Product Information</h4>
<p><strong>Purpose:</strong> This tool provides customers with comprehensive product details including warranties, available models, key features, shipping policies, and return information. It helps customers make informed purchasing decisions and understand what they’re buying.</p>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:43:28.746784Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:43:28.746516Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:43:28.754436Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:43:28.753870Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:43:28.746764Z&quot;}}" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">@tool</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_product_info(product_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Get detailed technical specifications and information for electronics products.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">        product_type: Electronics product type (e.g., 'laptops', 'smartphones', 'headphones', 'monitors')</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Formatted product information including warranty, features, and policies</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mock product catalog - in real implementation, this would query a product database</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    products <span class="op">=</span> {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"laptops"</span>: {</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"1-year manufacturer warranty + optional extended coverage"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"specs"</span>: <span class="st">"Intel/AMD processors, 8-32GB RAM, SSD storage, various display sizes"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"features"</span>: <span class="st">"Backlit keyboards, USB-C/Thunderbolt, Wi-Fi 6, Bluetooth 5.0"</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"compatibility"</span>: <span class="st">"Windows 11, macOS, Linux support varies by model"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"support"</span>: <span class="st">"Technical support and driver updates included"</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"smartphones"</span>: {</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"1-year manufacturer warranty"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"specs"</span>: <span class="st">"5G/4G connectivity, 128GB-1TB storage, multiple camera systems"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"features"</span>: <span class="st">"Wireless charging, water resistance, biometric security"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"compatibility"</span>: <span class="st">"iOS/Android, carrier unlocked options available"</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"support"</span>: <span class="st">"Software updates and technical support included"</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"headphones"</span>: {</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"1-year manufacturer warranty"</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"specs"</span>: <span class="st">"Wired/wireless options, noise cancellation, 20Hz-20kHz frequency"</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">"features"</span>: <span class="st">"Active noise cancellation, touch controls, voice assistant"</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">"compatibility"</span>: <span class="st">"Bluetooth 5.0+, 3.5mm jack, USB-C charging"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"support"</span>: <span class="st">"Firmware updates via companion app"</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"monitors"</span>: {</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"warranty"</span>: <span class="st">"3-year manufacturer warranty"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"specs"</span>: <span class="st">"4K/1440p/1080p resolutions, IPS/OLED panels, various sizes"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"features"</span>: <span class="st">"HDR support, high refresh rates, adjustable stands"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"compatibility"</span>: <span class="st">"HDMI, DisplayPort, USB-C inputs"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">"support"</span>: <span class="st">"Color calibration and technical support"</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    product <span class="op">=</span> products.get(product_type.lower())</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> product:</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Technical specifications for </span><span class="sc">{</span>product_type<span class="sc">}</span><span class="ss"> not available. Please contact our technical support team for detailed product information and compatibility requirements."</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"Technical Information - </span><span class="sc">{</span>product_type<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">:</span><span class="ch">\n\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Warranty: </span><span class="sc">{</span>product[<span class="st">'warranty'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Specifications: </span><span class="sc">{</span>product[<span class="st">'specs'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Key Features: </span><span class="sc">{</span>product[<span class="st">'features'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Compatibility: </span><span class="sc">{</span>product[<span class="st">'compatibility'</span>]<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="op">\</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>           <span class="ss">f"• Support: </span><span class="sc">{</span>product[<span class="st">'support'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✅ get_product_info tool ready"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ get_product_info tool ready</code></pre>
</div>
</div>
</section>
<section id="tool-3-web-search" class="level4">
<h4 class="anchored" data-anchor-id="tool-3-web-search">Tool 3: Web-search</h4>
<p><strong>Purpose:</strong> This tool allows customers to get troubleshooting support or suggestions on product recommendations etc.</p>
<div id="cell-13" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:44:14.195675Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:44:14.195413Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:44:14.202559Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:44:14.202028Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:44:14.195654Z&quot;}}" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="at">@tool</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> web_search(keywords: <span class="bu">str</span>, region: <span class="bu">str</span> <span class="op">=</span> <span class="st">"us-en"</span>, max_results: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Search the web for updated information.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">        keywords (str): The search query keywords.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">        region (str): The search region: wt-wt, us-en, uk-en, ru-ru, etc..</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">        max_results (int | None): The maximum number of results to return.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">        List of dictionaries with search results.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        results <span class="op">=</span> DDGS().text(keywords, region<span class="op">=</span>region, max_results<span class="op">=</span>max_results)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> results <span class="cf">if</span> results <span class="cf">else</span> <span class="st">"No results found."</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> RatelimitException:</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Rate limit reached. Please try again later."</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> DDGSException <span class="im">as</span> e:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Search error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Search error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✅ Web search tool ready"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Web search tool ready</code></pre>
</div>
</div>
</section>
<section id="customer-support-agent---knowledge-base-integration-steps" class="level4">
<h4 class="anchored" data-anchor-id="customer-support-agent---knowledge-base-integration-steps">Customer Support Agent - Knowledge Base Integration Steps</h4>
<section id="download-product-technical_support-files-from-s3" class="level5">
<h5 class="anchored" data-anchor-id="download-product-technical_support-files-from-s3">Download product technical_support files from S3</h5>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:45:00.635569Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:45:00.635286Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:45:01.083238Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:45:01.082579Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:45:00.635547Z&quot;}}" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and ingest file into BedRock Ecosystem</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_files():</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get account and region</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    account_id <span class="op">=</span> boto3.client(<span class="st">'sts'</span>).get_caller_identity()[<span class="st">'Account'</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    region <span class="op">=</span> boto3.Session().region_name</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    bucket_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>account_id<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">-kb-data-bucket"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create local folder</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">"knowledge_base_data"</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download all files</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    s3 <span class="op">=</span> boto3.client(<span class="st">'s3'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    objects <span class="op">=</span> s3.list_objects_v2(Bucket<span class="op">=</span>bucket_name)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> obj <span class="kw">in</span> objects[<span class="st">'Contents'</span>]:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        file_name <span class="op">=</span> obj[<span class="st">'Key'</span>]</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        s3.download_file(bucket_name, file_name, <span class="ss">f"knowledge_base_data/</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Downloaded: </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"All files saved to: knowledge_base_data/"</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Run it</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>download_files()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloaded: laptop-maintenance-guide.txt
Downloaded: monitor-calibration-guide.txt
Downloaded: smartphone-setup-guide.txt
Downloaded: troubleshooting-guide.txt
Downloaded: warranty-service-guide.txt
Downloaded: wireless-connectivity-guide.txt
All files saved to: knowledge_base_data/</code></pre>
</div>
</div>
</section>
</section>
<section id="knowledge-base-sync-job" class="level4">
<h4 class="anchored" data-anchor-id="knowledge-base-sync-job">Knowledge Base Sync Job</h4>
<section id="sync-the-knowledge-base-with-product-technical_support-files-from-s3-which-can-be-integrated-with-the-agent" class="level5">
<h5 class="anchored" data-anchor-id="sync-the-knowledge-base-with-product-technical_support-files-from-s3-which-can-be-integrated-with-the-agent">Sync the knowledge base with product technical_support files from S3 which can be integrated with the agent</h5>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:45:52.076589Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:45:52.076322Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:46:03.495944Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:46:03.495275Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:45:52.076569Z&quot;}}" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> boto3</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get parameters</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ssm <span class="op">=</span> boto3.client(<span class="st">'ssm'</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>bedrock <span class="op">=</span> boto3.client(<span class="st">'bedrock-agent'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> boto3.client(<span class="st">'s3'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>account_id <span class="op">=</span> boto3.client(<span class="st">'sts'</span>).get_caller_identity()[<span class="st">'Account'</span>]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>region <span class="op">=</span> boto3.Session().region_name</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>kb_id <span class="op">=</span> ssm.get_parameter(Name<span class="op">=</span><span class="ss">f"/</span><span class="sc">{</span>account_id<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">/kb/knowledge-base-id"</span>)[<span class="st">'Parameter'</span>][<span class="st">'Value'</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>ds_id <span class="op">=</span> ssm.get_parameter(Name<span class="op">=</span><span class="ss">f"/</span><span class="sc">{</span>account_id<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">/kb/data-source-id"</span>)[<span class="st">'Parameter'</span>][<span class="st">'Value'</span>]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get file names from S3 bucket</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>bucket_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>account_id<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">-kb-data-bucket"</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>s3_objects <span class="op">=</span> s3.list_objects_v2(Bucket<span class="op">=</span>bucket_name)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>file_names <span class="op">=</span> [obj[<span class="st">'Key'</span>] <span class="cf">for</span> obj <span class="kw">in</span> s3_objects.get(<span class="st">'Contents'</span>, [])]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Start sync job</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> bedrock.start_ingestion_job(</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    knowledgeBaseId<span class="op">=</span>kb_id,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    dataSourceId<span class="op">=</span>ds_id,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"Quick sync"</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>job_id <span class="op">=</span> response[<span class="st">'ingestionJob'</span>][<span class="st">'ingestionJobId'</span>]</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bedrock knowledge base sync job started, ingesting the data files from s3"</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Monitor until complete</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    job <span class="op">=</span> bedrock.get_ingestion_job(</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        knowledgeBaseId<span class="op">=</span>kb_id,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        dataSourceId<span class="op">=</span>ds_id,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        ingestionJobId<span class="op">=</span>job_id</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    )[<span class="st">'ingestionJob'</span>]</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    status <span class="op">=</span> job[<span class="st">'status'</span>]</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> status <span class="kw">in</span> [<span class="st">'COMPLETE'</span>, <span class="st">'FAILED'</span>]:</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">10</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Print final result</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> status <span class="op">==</span> <span class="st">'COMPLETE'</span>:</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    file_count <span class="op">=</span> job.get(<span class="st">'statistics'</span>, {}).get(<span class="st">'numberOfDocumentsScanned'</span>, <span class="dv">0</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    files_list <span class="op">=</span> <span class="st">', '</span>.join(file_names)</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Bedrock knowledge base sync job completed Successfully, ingested </span><span class="sc">{</span>file_count<span class="sc">}</span><span class="ss"> files"</span>)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Files ingested: </span><span class="sc">{</span>files_list<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Bedrock knowledge base sync job failed with status: </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bedrock knowledge base sync job started, ingesting the data files from s3
Bedrock knowledge base sync job completed Successfully, ingested 6 files
Files ingested: laptop-maintenance-guide.txt, monitor-calibration-guide.txt, smartphone-setup-guide.txt, troubleshooting-guide.txt, warranty-service-guide.txt, wireless-connectivity-guide.txt</code></pre>
</div>
</div>
</section>
</section>
<section id="tool-4-get-technical-support" class="level4">
<h4 class="anchored" data-anchor-id="tool-4-get-technical-support">Tool 4: Get Technical Support</h4>
<p><strong>Purpose:</strong> This tool provides customers with comprehensive technical support and troubleshooting assistance by accessing our knowledge base of electronics documentation. It includes detailed setup guides, maintenance instructions, troubleshooting steps, connectivity solutions, and warranty service information. This tool helps customers resolve technical issues, properly configure their devices, and understand maintenance requirements for optimal product performance.</p>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:47:37.066688Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:47:37.066407Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:47:37.532854Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:47:37.532278Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:47:37.066666Z&quot;}}" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands.tools.mcp.mcp_client <span class="im">import</span> MCPClient</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mcp.client.stdio <span class="im">import</span> stdio_client</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mcp.client.stdio <span class="im">import</span> StdioServerParameters</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands.models <span class="im">import</span> BedrockModel</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands <span class="im">import</span> Agent</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands_tools <span class="im">import</span> retrieve</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="at">@tool</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_technical_support(issue_description: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get KB ID from parameter store</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        ssm <span class="op">=</span> boto3.client(<span class="st">'ssm'</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        account_id <span class="op">=</span> boto3.client(<span class="st">'sts'</span>).get_caller_identity()[<span class="st">'Account'</span>]</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        region <span class="op">=</span> boto3.Session().region_name</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        kb_id <span class="op">=</span> ssm.get_parameter(Name<span class="op">=</span><span class="ss">f"/</span><span class="sc">{</span>account_id<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>region<span class="sc">}</span><span class="ss">/kb/knowledge-base-id"</span>)[<span class="st">'Parameter'</span>][<span class="st">'Value'</span>]</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Successfully retrieved KB ID: </span><span class="sc">{</span>kb_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use strands retrieve tool</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        tool_use <span class="op">=</span> {</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"toolUseId"</span>: <span class="st">"tech_support_query"</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"input"</span>: {</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">"text"</span>: issue_description,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">"knowledgeBaseId"</span>: kb_id,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                <span class="st">"region"</span>: region,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">"numberOfResults"</span>: <span class="dv">3</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">"score"</span>: <span class="fl">0.4</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> retrieve.retrieve(tool_use)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> result[<span class="st">"status"</span>] <span class="op">==</span> <span class="st">"success"</span>:</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result[<span class="st">"content"</span>][<span class="dv">0</span>][<span class="st">"text"</span>]</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f"Unable to access technical support documentation. Error: </span><span class="sc">{</span>result[<span class="st">'content'</span>][<span class="dv">0</span>][<span class="st">'text'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Detailed error in get_technical_support: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"Unable to access technical support documentation. Error: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✅ Technical support tool ready"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Technical support tool ready</code></pre>
</div>
</div>
</section>
</section>
<section id="step-4-create-and-configure-the-customer-support-agent" class="level3">
<h3 class="anchored" data-anchor-id="step-4-create-and-configure-the-customer-support-agent">Step 4: Create and Configure the Customer Support Agent</h3>
<p>Next, we will create the Customer Support Agent providing a model, the list of tools implemented in the previous step, and with a system prompt.</p>
<div id="cell-21" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:48:13.254056Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:48:13.253761Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:48:13.321947Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:48:13.321378Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:48:13.254036Z&quot;}}" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands <span class="im">import</span> Agent</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> strands.models <span class="im">import</span> BedrockModel</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>SYSTEM_PROMPT <span class="op">=</span> <span class="st">"""You are a helpful and professional customer support assistant for an electronics e-commerce company.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">Your role is to:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">- Provide accurate information using the tools available to you</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">- Support the customer with technical information and product specifications, and maintenance questions</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">- Be friendly, patient, and understanding with customers</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">- Always offer additional help after answering questions</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">- If you can't help with something, direct customers to the appropriate contact</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">You have access to the following tools:</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="st">1. get_return_policy() - For warranty and return policy questions</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">2. get_product_info() - To get information about a specific product</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">3. web_search() - To access current technical documentation, or for updated information. </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">4. get_technical_support() - For troubleshooting issues, setup guides, maintenance tips, and detailed technical assistance</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">For any technical problems, setup questions, or maintenance concerns, always use the get_technical_support() tool as it contains our comprehensive technical documentation and step-by-step guides.</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="st">Always use the appropriate tool to get accurate, up-to-date information rather than making assumptions about electronic products or specifications."""</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the Bedrock model (Anthropic Claude 3.7 Sonnet)</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> BedrockModel(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    model_id<span class="op">=</span><span class="st">"us.anthropic.claude-3-7-sonnet-20250219-v1:0"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    region_name<span class="op">=</span>region</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the customer support agent with all tools</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>agent <span class="op">=</span> Agent(</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span>model,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    tools<span class="op">=</span>[</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>        get_product_info,  <span class="co"># Tool 1: Simple product information lookup</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        get_return_policy,  <span class="co"># Tool 2: Simple return policy lookup</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        web_search, <span class="co"># Tool 3: Access the web for updated information</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        get_technical_support   <span class="co"># Tool 4: Technical support &amp; troubleshooting</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    system_prompt<span class="op">=</span>SYSTEM_PROMPT,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Customer Support Agent created successfully!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Customer Support Agent created successfully!</code></pre>
</div>
</div>
</section>
<section id="step-5-test-the-customer-support-agent" class="level3">
<h3 class="anchored" data-anchor-id="step-5-test-the-customer-support-agent">Step 5: Test the Customer Support Agent</h3>
<p>Let’s test our agent with sample queries to ensure all tools work correctly.</p>
<section id="test-return-check" class="level4">
<h4 class="anchored" data-anchor-id="test-return-check">Test Return check</h4>
<div id="cell-23" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:48:22.774311Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:48:22.774049Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:48:30.858094Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:48:30.857497Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:48:22.774290Z&quot;}}" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> agent(<span class="st">"What's the return policy for my thinkpad X1 Carbon?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>I'd be happy to provide you with information about the return policy for your ThinkPad X1 Carbon. Let me look that up for you.
Tool #1: get_return_policy
Thank you for your patience. Here's the return policy for your ThinkPad X1 Carbon:

**Return Policy for Laptops (including ThinkPad X1 Carbon):**
- You have a 30-day return window from the date of delivery
- The laptop must be returned in its original packaging with all accessories included
- No software modifications should be made to the device
- Before processing a return, our technical support team will need to verify the condition
- Once approved and inspected, refunds are processed within 7-10 business days
- Return shipping is free when using the original packaging
- Your ThinkPad X1 Carbon comes with a 1-year manufacturer warranty, with options to extend

Is there anything specific about the return policy you'd like me to clarify? Or perhaps you're experiencing an issue with your ThinkPad that I could help troubleshoot?</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:53:56.065702Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:53:56.065436Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:54:09.778566Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:54:09.777976Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:53:56.065684Z&quot;}}" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> agent(<span class="st">"My laptop won't turn on, what should I check?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>I'd be happy to help you troubleshoot your laptop that won't turn on. Let me get some technical support information for you.
Tool #6: get_technical_support
Successfully retrieved KB ID: LJ150KSVHW
Based on the technical support information, here are the steps you should take when your laptop won't turn on:

### Initial Power Troubleshooting Steps:

1. **Check Power Cable Connections**
   - Ensure the power adapter is firmly connected to both your laptop and the wall outlet
   - Look for any visible damage to the cable (fraying, bent pins, etc.)
   - Check that the connection point on the laptop isn't loose or damaged

2. **Verify Power Outlet Functionality**
   - Try plugging another device into the same outlet to confirm it's working
   - Try a different power outlet to rule out electrical issues
   - If using a power strip or surge protector, try bypassing it and plugging directly into the wall

3. **Try a Different Power Cable if Available**
   - If you have access to another compatible power adapter, see if that resolves the issue
   - This can help determine if the problem is with the adapter rather than the laptop

4. **Check for Physical Damage**
   - Inspect your laptop for any signs of physical damage
   - Look for liquid damage indicators if applicable

### Additional Troubleshooting Steps:

1. **Battery Reset**
   - If your laptop has a removable battery, remove it and the power cable
   - Hold the power button for 30 seconds to discharge any residual power
   - Reconnect the battery and power cable, then try turning it on again

2. **Check for Signs of Life**
   - Look for any LED indicators that might light up when connected to power
   - Listen for fan noise or hard drive spinning
   - Check if the caps lock or num lock keys respond with their indicator lights

3. **External Display Test**
   - Connect your laptop to an external monitor to see if it's just a display issue
   - If the external monitor works, your laptop is powering on but has a screen issue

If none of these steps resolve the issue, your laptop might have a more serious hardware problem such as a failed motherboard, power supply, or other internal component that would require professional service.

Would you like me to provide more details on any of these troubleshooting steps? Or would you like information about our repair services for your laptop?</code></pre>
</div>
</div>
</section>
<section id="test-troubleshooting" class="level4">
<h4 class="anchored" data-anchor-id="test-troubleshooting">Test Troubleshooting</h4>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;execution&quot;,&quot;value&quot;:{&quot;iopub.execute_input&quot;:&quot;2025-09-17T11:51:28.305702Z&quot;,&quot;iopub.status.busy&quot;:&quot;2025-09-17T11:51:28.305438Z&quot;,&quot;iopub.status.idle&quot;:&quot;2025-09-17T11:51:48.237257Z&quot;,&quot;shell.execute_reply&quot;:&quot;2025-09-17T11:51:48.236673Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2025-09-17T11:51:28.305681Z&quot;}}" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> agent(<span class="st">"I bought an iphone 14 last month. I don't like it because it heats up. How do I solve it?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>I'm sorry to hear about the heating issue with your iPhone 14. Let me help you troubleshoot this problem. First, let me get some technical support information for you.
Tool #3: get_technical_support
Successfully retrieved KB ID: LJ150KSVHW
I see that the technical support information doesn't provide specific guidance for iPhone overheating issues. Let me search for more current information about iPhone 14 heating problems and solutions.
Tool #4: web_search
Now, let me also check if there's any specific product information about the iPhone 14 that might be relevant to your issue.
Tool #5: get_product_info
Based on the information I've gathered, here are some solutions to help with your iPhone 14 overheating issue:

### Why iPhones Can Overheat:
- Resource-intensive apps running in the background
- Software bugs in iOS updates
- Charging while using demanding applications
- Environmental factors (direct sunlight, hot environments)
- Hardware issues (rare but possible)

### Solutions to Fix iPhone 14 Overheating:

1. **Update iOS to the Latest Version**
   - Go to Settings &gt; General &gt; Software Update
   - Install any available updates as they often include thermal management improvements

2. **Check and Close Background Apps**
   - Double-click the home button or swipe up from the bottom (depending on your model) to view open apps
   - Swipe up on apps to close them, especially resource-intensive ones like games or navigation

3. **Manage Battery-Draining Features**
   - Reduce screen brightness (Settings &gt; Display &amp; Brightness)
   - Turn off unnecessary location services (Settings &gt; Privacy &gt; Location Services)
   - Disable Background App Refresh (Settings &gt; General &gt; Background App Refresh)

4. **Remove Case Temporarily**
   - Some cases can trap heat; try using your iPhone without its case to see if it helps

5. **Avoid Direct Sunlight and Hot Environments**
   - Keep your iPhone away from heat sources and direct sunlight

6. **Check for Problematic Apps**
   - Go to Settings &gt; Battery to see which apps use the most power
   - Update or delete apps that might be causing excessive heat

7. **Reset All Settings**
   - Settings &gt; General &gt; Reset &gt; Reset All Settings (this won't delete your data)

If you've tried these solutions and your iPhone 14 still overheats excessively, it might indicate a hardware issue. Since you purchased it last month, your device is still under the 1-year manufacturer warranty, and you have options:

1. **Contact Apple Support** for further assistance
2. **Visit an Apple Store** for a hardware diagnosis
3. **Consider returning the device** - Since you mentioned you don't like it and it's only been a month, you might still be within the return window

Would you like me to provide more details on any of these solutions? Or would you like information about the return policy for smartphones if you decide you want to return it?</code></pre>
</div>
</div>
</section>
</section>
<section id="lab-1-complete" class="level2">
<h2 class="anchored" data-anchor-id="lab-1-complete">🎉 Lab 1 Complete!</h2>
<p>You’ve successfully created a functional Customer Support Agent prototype! Here’s what you accomplished:</p>
<ul>
<li>Built an agent with 3 custom tools (return policy, product info, web search)<br>
</li>
<li>Tested multi-tool interactions and web search capabilities<br>
</li>
<li>Established the foundation for our production journey</li>
</ul>
<section id="current-limitations-well-fix-these" class="level3">
<h3 class="anchored" data-anchor-id="current-limitations-well-fix-these">Current Limitations (We’ll fix these!)</h3>
<ul>
<li><strong>Single user conversation memory</strong> - local conversation session, multiple customers need multiple sessions.</li>
<li><strong>Conversation history limited to session</strong> - no long term memory or cross session information is available in the conversation.</li>
<li><strong>Tools reusability</strong> - tools aren’t reusable across different agents<br>
</li>
<li><strong>Running locally only</strong> - not scalable</li>
<li><strong>Identity</strong> - No user and/or agent identity or access control</li>
<li><strong>Observability</strong> - Limited observability into agent behavior</li>
<li><strong>Existing APIs</strong> - No access to existing enterprise APIs for customer data</li>
</ul>
<section id="next-up-lab-2-personalize-our-agent-by-adding-memory" class="level5">
<h5 class="anchored" data-anchor-id="next-up-lab-2-personalize-our-agent-by-adding-memory">Next Up <a href="../../code_files/aws_agentcore/lab-02-agentcore-memory.html">Lab 2: Personalize our agent by adding memory →</a></h5>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>A hub for showcasing my portfolio, AI and tech blogs, creative drawings, and podcast episodes. All opinions are my own.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2025 Aarushi Nema
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/aarushi-nema">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/aarushi-nema-64a006185/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>